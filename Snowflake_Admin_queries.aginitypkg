{"entities":[{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Get Tables from Data Dictionary","id":"03af6e2e-59d6-4cb7-854d-efa36246fbac","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Get Tables from Data Dictionary","entity_type":"SQL_ENTITY","description":"This script will take a schema parameter and return all tables in a Snowflake database","content":"select t.table_name\nfrom information_schema.tables t\nwhere t.table_schema = $ENTER_SCHEMA  -- put schema name here\n      and t.table_type = 'BASE TABLE'\norder by t.table_name;","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:07:04.437Z","executed_count":3},{"fqn":"/Samples","id":"05fc0bd0-3f7c-4113-a7a5-2a321b32a790","parent_folder_id":"bb6de4af-1aad-493e-a9ee-b3e75cf58ed7","name":"Samples","entity_type":"FOLDER"},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Get Tables Size in MB in a schema","id":"3b697ea1-fd29-4441-b730-b879817769e3","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Get Tables Size in MB in a schema","entity_type":"SQL_ENTITY","description":"","content":"select \r\n  table_catalog\r\n  , table_schema\r\n  , table_name\r\n  , round(sum(bytes)/1024/1024) as size_MB\r\nfrom \r\n  information_schema.tables\r\nwhere\r\n  upper(table_schema) not in ('INFORMATION_SCHEMA')\r\n  and (case when trim($table_schema) ='' then 1=1 else upper(table_schema) = upper(trim($table_schema)) end) \r\ngroup by \r\n  table_catalog,table_schema,table_name\r\norder by \r\n  4 desc","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-23T12:42:59.930Z","executed_count":9},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Recursive CTE numbers up to given number","id":"3c687bf4-7132-4b32-ba05-ee3e8a3fde06","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Recursive CTE numbers up to given number","entity_type":"SQL_ENTITY","description":"","content":"with d as (\r\n  select 1 as n\r\n  union ALL\r\n  select n+1 as n from d\r\n  where n < $num\r\n)\r\nselect * from d","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-28T10:01:06.741Z","executed_count":7},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Get running Queries","id":"499007ef-3dbc-4c21-982d-e216f01e6716","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Get running Queries","entity_type":"SQL_ENTITY","description":"Created from editor","content":"select *\r\nfrom table(information_schema.query_history_by_session())\r\norder by start_time","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:30:25.874Z","executed_count":1},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Get query history for the last N hours","id":"4dd7b211-eca1-4d49-a18d-e0543707ae0a","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Get query history for the last N hours","entity_type":"SQL_ENTITY","description":"Created from editor","content":"select \r\n  DATABASE_NAME\r\n  , QUERY_TYPE\r\n  , USER_NAME\r\n  , START_TIME\r\n  , TOTAL_ELAPSED_TIME\r\n  , ROWS_PRODUCED\r\n  , QUERY_TEXT\r\n  , EXECUTION_STATUS\r\n  , ERROR_CODE\r\n  , ERROR_MESSAGE\r\nfrom \r\n  table(information_schema.query_history(dateadd('hours',-$hours,current_timestamp()),current_timestamp()))\r\norder by \r\n  start_time","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:26:43.363Z","executed_count":2},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Generate table of increment dates","id":"6c38c825-37eb-4e26-a309-21c43088f9f8","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Generate table of increment dates","entity_type":"SQL_ENTITY","description":"Created from editor","content":"select \r\n    dateadd(day, '-' || seq4(), current_date()) as dt \r\nfrom \r\n    table (generator(rowcount => $days))","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:35:52.885Z","executed_count":1},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Get tables DDL stmt in a schema","id":"70d1d501-d04f-4e1a-bc16-f7452a92d32f","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Get tables DDL stmt in a schema","entity_type":"SQL_ENTITY","description":"","content":"SELECT \r\n  'SELECT GET_DDL(''TABLE'',''' ||  table_schema || '.' || table_name || ''');' AS stmt\r\nFROM \r\n  INFORMATION_SCHEMA.TABLES \r\nWHERE\r\n  upper(table_schema) not in ('INFORMATION_SCHEMA')\r\n  and (case when trim($table_schema) ='' then 1=1 else upper(table_schema) = upper(trim($table_schema)) end)","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:06:01.754Z","executed_count":4},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake","id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","parent_folder_id":"05fc0bd0-3f7c-4113-a7a5-2a321b32a790","name":"Sample Data Engineering Queries - Snowflake","entity_type":"FOLDER"},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Get SELECT stmt for 1 row sample for each table in a schema","id":"b07e4feb-c22e-4f80-a16a-81027a3293d2","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Get SELECT stmt for 1 row sample for each table in a schema","entity_type":"SQL_ENTITY","description":"","content":"select \r\n  concat('select ''',t.table_name,''', * from ', table_schema, '.', t.table_name, ' limit 1;') as stmt\r\nfrom \r\n  information_schema.tables t\r\nwhere \r\n  t.table_type = 'BASE TABLE'\r\n  and upper(table_schema) not in ('INFORMATION_SCHEMA')\r\n  and (case when trim($table_schema) ='' then 1=1 else upper(table_schema) = upper(trim($table_schema)) end)  \r\norder by \r\n  t.table_name;","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:05:41.697Z","executed_count":5},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Show Tables in a schema","id":"bbd6bce6-114f-4201-a0ad-8e9eb14164ea","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Show Tables in a schema","entity_type":"SQL_ENTITY","description":"","content":"show tables in schema identifier($schema);","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-23T12:42:48.487Z","executed_count":5},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Get Constraints on tables for given schema","id":"d10e8453-6355-43e9-8226-87376c1fa1e4","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Get Constraints on tables for given schema","entity_type":"SQL_ENTITY","description":"","content":"SELECT \r\n  table_name\r\n  , constraint_type\r\n  , constraint_name\r\nFROM \r\n  information_schema.table_constraints\r\nWHERE \r\n  (case when trim($schema_name) ='' then 1=1 else upper(constraint_schema) = upper(trim($schema_name)) end) \r\nORDER BY \r\n  table_name","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:05:27.106Z","executed_count":6},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Generate table of numbers from 0 to N","id":"da3ab646-0c33-4c34-a801-104260742608","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Generate table of numbers from 0 to N","entity_type":"SQL_ENTITY","description":"Created from editor","content":"select \r\n    seq4()\r\nfrom \r\n    table (generator(rowcount => $Num))","type":"QUERY","platform":"Snowflake","executed_count":0},{"fqn":"/Samples/Sample Data Engineering Queries - Snowflake/Generate DROP tables in schema","id":"f1bbb0fd-2ca2-46e6-af7f-8527aa5fdfff","parent_folder_id":"8f7a9ec0-6543-42e6-baca-4c98c97e9b73","name":"Generate DROP tables in schema","entity_type":"SQL_ENTITY","description":"Created from editor","content":"SELECT \r\n  'drop table '||table_name||' cascade;' as stmt\r\nFROM \r\n  information_schema.tables tables\r\nWHERE \r\n  upper(table_schema) not in ('INFORMATION_SCHEMA')\r\n  and (case when trim($table_schema) ='' then 1=1 else upper(table_schema) = upper(trim($table_schema)) end)\r\nORDER BY 1","type":"QUERY","platform":"Snowflake","executed_at":"2019-08-30T08:16:18.769Z","executed_count":1}]}